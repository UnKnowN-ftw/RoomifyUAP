{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="{% static 'images/roomify_favicon.png' %}" />
    <title>Edit Listing - Roomify UAP</title>
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="{% static 'css/edit_listing_styles.css' %}" />
  </head>
  <body>
    <!-- Navbar -->
    <header class="navbar">
      <div class="logo">
        <img src="{% static 'images/ROOMIFY.png' %}" alt="Logo" />
        <div class="logo-text">
          <h2>Roomify UAP</h2>
          <p>Edit Listing</p>
        </div>
      </div>

      <nav class="nav-links">
        <a href="{% url 'owner_dashboard' %}">Home</a>
        <a href="{% url 'owner_listings' %}">My Listings</a>
        <a href="{% url 'owner_analytics' %}">Analytics</a>
      </nav>

      <div class="profile-section">
        <div class="profile-dropdown">
          <i class="bx bx-user"></i>
          <ul class="dropdown-menu">
            <li>
              <a href="{% url 'owner_profile' %}">Profile</a>
            </li>
            <li>
              <a href="{% url 'owner_messages' %}">Messages</a>
            </li>
            <li>
              <a href="{% url 'logout_user' %}" class="logout-link">Logout</a>
            </li>
          </ul>
        </div>
      </div>
    </header>

    <!-- Edit Listing Section -->
    <section class="edit-listing-section">
      <div class="container">
        <h2>Edit Listing</h2>

        <!-- Update Listing Form -->
        <form method="POST" enctype="multipart/form-data" class="edit-listing-form">
          {% csrf_token %}

          <label>Room Title</label>
          <input type="text" name="room_title" value="{{ listing.room_title }}" required />

          <label>Location</label>
          <input type="text" name="location" value="{{ listing.location }}" required />

          <label>Rent (৳/month)</label>
          <input type="number" name="rent" value="{{ listing.rent }}" required />

          <label>Room Size (sq ft)</label>
          <input type="number" name="room_size" value="{{ listing.room_size }}" />

          <label>Occupancy</label>
          <input type="number" name="occupancy" value="{{ listing.occupancy }}" />

          <label>Description</label>
          <textarea name="description">{{ listing.description }}</textarea>

          <label>Image</label>
          {% if listing.image %}
            <img src="{{ listing.image.url }}" alt="Current Image" class="preview-image" />
          {% endif %}
          <input type="file" name="image" />

          <div class="form-actions">
            <button type="submit" class="update-btn">Update Listing</button>
            <a href="{% url 'owner_listings' %}" class="cancel-btn">Cancel</a>
          </div>
        </form>

        <!-- Delete Listing Section -->
        <div class="delete-listing-container" style="margin-top: 20px;">
          <form method="POST" action="{% url 'delete_listing' listing.id %}" onsubmit="return confirm('Are you sure you want to delete this listing?');">
            {% csrf_token %}
            <button type="submit" class="delete-btn" style="width: 100%; background-color: #e74c3c; color: white; padding: 12px; border: none; border-radius: 5px; cursor: pointer;">Delete Listing</button>
          </form>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Roomify UAP</h3>
          <p>Empowering hostel and rental owners with smart tools.</p>
        </div>
      </div>
      <div class="footer-bottom">© 2025 Roomify UAP | All rights reserved</div>
    </footer>

    <script>
      // Profile dropdown toggle
      const profileDropdown = document.querySelector('.profile-dropdown')
      profileDropdown.addEventListener('click', (e) => {
        e.stopPropagation()
        profileDropdown.classList.toggle('active')
      })
      document.addEventListener('click', () => profileDropdown.classList.remove('active'))
    </script>
  </body>
</html>
