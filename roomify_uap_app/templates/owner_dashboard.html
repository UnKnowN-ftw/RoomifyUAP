{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/png"
      href="{% static 'images/roomify_favicon.png' %}"
    />
    <title>Roomify UAP - Owner Dashboard</title>
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{% static 'css/owner_dashboard_styles.css' %}"
    />
  </head>
  <body>
    <!-- Navbar -->
     <header class="navbar">
      <div class="logo">
        <img src="{% static 'images/ROOMIFY.png' %}" alt="Logo" />
        <div>
          <h2>Roomify UAP</h2>
          <p>Owner Dashboard</p>
        </div>
      </div>
      <nav class="nav-links">
        <a href="#">Home</a>
        <a href="#">My Listings</a>
        <a href="#">Analytics</a>
        <a href="#">Messages</a>
      </nav>
      <div class="profile-icon">
  <!-- Notification Bell + Dropdown -->
  <div class="notification-wrapper">
    <i class="bx bx-bell" id="notifBell"></i>
    {% if notification_count > 0 %}
      <span class="notif-count">{{ notification_count }}</span>
    {% endif %}

    <div class="notif-dropdown" id="notifDropdown">
      {% for req in notifications %}
        <div class="notif-item">
          <p>{{ req.renter.username }} wants to book "{{ req.listing.room_title }}".</p>
          <div class="notif-actions">
            <form method="POST" action="{% url 'booking_accept' req.id %}">
              {% csrf_token %}
              <button type="submit" class="accept-btn">Accept</button>
            </form>
            <form method="POST" action="{% url 'booking_reject' req.id %}">
              {% csrf_token %}
              <button type="submit" class="reject-btn">Reject</button>
            </form>
          </div>
        </div>
      {% empty %}
        <p class="no-notifs">No new requests</p>
      {% endfor %}
    </div>
  </div>

  <!-- Profile + Logout -->
  <a href="{% url 'owner_profile' %}"><i class="bx bx-user"></i></a>
  <a href="{% url 'logout_user' %}">Logout</a>
</div>

    </header> 

    <!-- Owner Overview Section -->
    <section class="owner-summary">
      <h1>Welcome back, Owner!</h1>
      <p>Manage your hostel listings and track performance</p>

      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Listings</h3>
          <h2>3</h2>
          <p>+2 this month</p>
        </div>
        <div class="stat-card">
          <h3>Occupancy Rate</h3>
          <h2>85%</h2>
          <p>+5% from last month</p>
        </div>
        <div class="stat-card">
          <h3>Monthly Revenue</h3>
          <h2>৳85,000</h2>
          <p>From 18 tenants</p>
        </div>
        <div class="stat-card">
          <h3>Total Views</h3>
          <h2>1,284</h2>
          <p>+18% this week</p>
        </div>
      </div>

      <a href="{% url 'post_new_listing' %}" class="new-listing-btn">+ Post New Listing</a>

    </section>

    <!-- Active Listings -->
    <section class="active-listings">
      <h2>Your Active Listings</h2>
      <p>Manage and monitor your hostel rooms</p>

      <div class="listing-container">
  {% if listings %}
    {% for room in listings %}
      <div class="owner-card">
        {% if room.image %}
          <img src="{{ room.image.url }}" alt="{{ room.room_title }}" />
        {% else %}
          <img src="{% static 'images/default-room.jpg' %}" alt="Room" />
        {% endif %}
        <div class="info">
          <h3>{{ room.room_title }}</h3>
          <p>{{ room.location }}</p>
          <p>৳{{ room.rent }}/month | {{ room.room_size }} sq ft | {{ room.occupancy }}/{{ room.max_occupancy }} occupied</p>
        </div>
        <div class="actions">
          <button type="button">Edit</button>
          <button type="button">View</button>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p>You haven't posted any listings yet.</p>
  {% endif %}
</div>

    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Roomify UAP</h3>
          <p>Empowering hostel and rental owners with smart tools.</p>
        </div>

        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">My Listings</a></li>
            <li><a href="#">Analytics</a></li>
            <li><a href="#">Messages</a></li>
            <li><a href="#">FAQ</a></li>
          </ul>
        </div>

        <div class="footer-section">
          <h4>Contact Us</h4>
          <ul>
            <li>Email: support@roomifyuap.com</li>
            <li>Phone: +8801796968195</li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">© 2025 Roomify UAP | All rights reserved</div>
    </footer>

  <script>
  document.getElementById("notifBell").addEventListener("click", function () {
    const dropdown = document.getElementById("notifDropdown");
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  document.addEventListener("click", function (e) {
    const dropdown = document.getElementById("notifDropdown");
    const bell = document.getElementById("notifBell");
    if (!dropdown.contains(e.target) && e.target !== bell) {
      dropdown.style.display = "none";
    }
  });
</script>

  </body>
</html>
